import pandas as pd

class WeatherClassifier:
    def __init__(self, input_file, output_file):
        self.input_file = input_file
        self.output_file = output_file

    def read_file(self):
        self.df = pd.read_csv(self.input_file, delimiter=';', decimal=',', parse_dates=['Zeilenbeschriftungen'])
        print("File read successfully.")

    def classify_weather(self, row):
        if row['Mittelwert von wind_speed'] > 6:
            return 'bad'
        elif row['Min. von temp_min'] < -5:
            return 'bad'
        elif row['Max. von temp_max'] > 30:
            return 'bad'
        elif row['Mittelwert von humidity'] > 80 and row['Min. von temp_min'] < 0:
            return 'bad'
        else:
            return 'good'

    def apply_classification(self):
        self.df['weather'] = self.df.apply(self.classify_weather, axis=1)
        print("Weather classification applied.")

    def print_results(self):
        print(self.df[['Zeilenbeschriftungen', 'weather']])

    def save_to_new_file(self):
        self.df.to_csv(self.output_file, index=False, sep=';', decimal=',')
        print(f"Results saved to {self.output_file}.")

# Example usage:
weather_classifier = WeatherClassifier('./Paris.csv', 'path_to_output_file.csv')
weather_classifier.read_file()
weather_classifier.apply_classification()
weather_classifier.print_results()
weather_classifier.save_to_new_file()